# This tests all sorts of edge cases. See the comments in `cgout-test3` for
# more details.
#
# The `prog` doesn't matter because we don't use its output. Instead we test
# the post-processing of the cgout-test file.
prog: ../../tests/true
vgopts: --cachegrind-out-file=cachegrind.out

# The `sleep` is to ensure the mtime of the second touched file is greater than
# the mtime of the first touched file.
post: touch cgout-test3 && sleep 0.1 && touch ann3-more-recent-than-cgout.rs && python3 ../../cachegrind/cg_annotate --context 2 --auto --show-percs=yes --threshold=0.5 -Iann3-no-such-dir --include ann3-no-such-dir-2 -I=ann3-aux cgout-test3 ann3-unmentioned.rs ann3-no-such-file.rs

cleanup: rm cachegrind.out
